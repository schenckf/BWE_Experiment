---
title: "PrelimAnalysis_19SEP2017"
author: "Forest Schenck"
date: "September 19, 2017"
output: pdf_document
---

#PACKAGES
```{r}
library(dplyr)
library(sciplot)

```

#Importing/wrangling data
```{r}
#setwd("~/Dropbox/EEMB Graduate/Research/ZosteraWastingDisease/Diveristy:Warming_Exp_BML/Analyses")

#d19SEP1 <- read.csv("bwe_data_19sep2017.csv") #importing from dropbox
#d03OCT1 <- read.csv("bwe_data_03OCT2017.csv") #importing from dropbox
d04DEC1 <- read.csv("bwe_data_04DEC2017.csv") #importing from dropbox
#str(d19SEP1)
str(d04DEC1)
```

#cell count/mg by genotype, diversity treatment, and temp. treatment
```{r}
bargraph.CI(x.factor = genotype,
            group = diversity,
            response = log(cell.mg + 1),
            data = filter(d04DEC1, cell.mg > 0), #do i want to exclude polys?
            ylim = c(0,10), ylab = "Log(cells per mg + 1)",
            xlab = "Genotype", legend = T)

bargraph.CI(x.factor = diversity,
            response = log(cell.mg + 1),
            data = filter(d04DEC1, cell.mg > 0),
            ylim = c(0,4), ylab = "Log(cells per mg + 1)",
            xlab = "Diversity Treatment")

bargraph.CI(x.factor = treatment,
            response = log(cell.mg + 1),
            data = filter(d04DEC1, cell.mg >0),
            ylim = c(0,4), ylab = "Log(cells per mg + 1)",
            xlab = "Temperature Treatment")

bargraph.CI(x.factor = treatment,
            group = diversity,
            response = log(cell.mg + 1),
            data = filter(d04DEC1, cell.mg > 0),
            ylim = c(0,4), ylab = "Log(cells per mg + 1)",
            xlab = "Diversity Treatment")
```

#cell presence by genotype, diversity treatment, and temp. treatment
```{r}
bargraph.CI(x.factor = genotype,
            group = diversity,
            response = cells.present,
            data = filter(d04DEC1),
            ylim = c(0,1),
            ylab = "Proportion of samples with cells present",
            xlab = "Genotype",
            uc = F, lc = F)

bargraph.CI(x.factor = diversity,
            response = cells.present,
            data = d04DEC1,
            ylim = c(0,1),
            ylab = "Proportion of samples with cells present",
            xlab = "Diversity Treatment",
            uc = F, lc = F)

bargraph.CI(x.factor = treatment,
            response = cells.present,
            data = d04DEC1,
            ylim = c(0,1),
            ylab = "Proportion of samples with cells present",
            xlab = "Temperature Treatment",
            uc = F, lc = F)

bargraph.CI(x.factor = treatment,
            group = diversity,
            response = cells.present,
            data = d04DEC1,
            ylim = c(0,1),
            ylab = "Proportion of samples with cells present",
            xlab = "Temperature Treatment",
            uc = F, lc = F)
```

#cell count per mg by lesion percent cover
```{r}
d04DEC1.intensity <- filter(d04DEC1, cell.mg > 0)

plot(d04DEC1.intensity$lc.FS, log(d04DEC1.intensity$cell.mg+1),
     xlab = "Lesion percent cover",
     ylab = "Log(cells per mg + 1)",
     main = "Lesion Intensity vs. Cell Intensity",
     ylim = c(0,10),
     xlim = c(0,100))

plot((d04DEC1$lc.FS), log(d04DEC1$cell.mg+1),
     xlab = "Lesion percent cover",
     ylab = "Log(cells per mg +1)",
     main = "Lesion % cover vs. Cell count/mg",
     ylim = c(0,10),
     xlim = c(0,100))
```

#Cell presence (qPCR) vs. lesion presence (visual)
```{r}
table.1 <- table(d04DEC1$lesion, d04DEC1$cells.present)

table.1

mosaicplot(table.1, main ="",
xlab = "lesion presence",
           ylab = "cell presence",
           col = T)

table.2 <- table(d04DEC1$lesion.group, d04DEC1$cells.present)
table.2

table.2 <- matrix(c(15,1,25,1,151,23,23,19),ncol=2,byrow=TRUE)
colnames(table.2) <- c("absent","present")
rownames(table.2) <- c("0","<1","<10",">10")
table.2 <- as.table(table.2)
table.2

mosaicplot(table.2, main = "",
           xlab = "lesion percent cover",
           ylab = "cell presence",
           col = T)
```




